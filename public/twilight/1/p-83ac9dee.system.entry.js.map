{"version":3,"names":["sallaOfferCss","SallaOffer","exports","class_1","hostRef","_this","this","salla","lang","get","price","quantity","onLoaded","offer_with_price_text","with_discount_text","product_discount_text","special_offer_text","buy_quantity_text","onReady","productId","url","is_page","config","userCurrency","categorySlot","_a","host","querySelector","innerHTML","prototype","getCategoriesSection","offeredCategories","map","category","h","class","replace","icon","name","getProductSection","offeredProducts","product","getBankSection","offeredBank","description","bank","isMultipleBank","src","logo","cdn","alt","payments","payment","percent","getDiscountTableSection","discountTable","discount","quantity_text","show_discounted_price","helpers","money","symbol","render","logger","error","offersList","length","offer","banks","type","message","id","slot","categories","products","discounts_table","componentWillLoad","api","offers","then","resp","data"],"sources":["src/components/salla-offer/salla-offer.scss?tag=salla-offer","src/components/salla-offer/salla-offer.tsx"],"sourcesContent":[".s-offer-wrapper .s-slider-block__title {\n  h2 {\n    font-size: 1.125rem;\n    line-height: 1.75rem;\n    color: #f87171;\n\n    &::before {\n      font-family: \"sallaicons\";\n      content: \"\\ee30\" !important;\n      position: absolute;\n      top: 1rem;\n      font-size: 3rem;\n      font-weight: 400;\n      line-height: 1;\n      color: #fef2f2;\n    }\n  }\n}\n\n.s-offer-bank-wrapper-sinlge-item{\n    display: flex;\n    align-items: center !important;\n    gap: 14px;\n}\n\n.s-offer-bank-wrapper {\n  display: flex !important;\n  width: 100% !important;\n}\n\n// .s-offer-bank-wrapper {\n  // \n// }","import { Component, Element, Prop, State, h } from '@stencil/core';\nimport { Offer, Category, Product, Discount, Currency, Bank, Payment } from \"./interfaces\"\n\n\n/**\n * `salla-offer` is a StencilJS component that displays offers, categories, products, banks, and discount information.\n * It uses the `salla-slider` component for carousel functionality.\n *\n * @slot category - The slot for customizing the category entry layout.\n * \n * @csspart custom - Custom CSS part to target specific elements in the component.\n *\n * @example\n * <salla-offer product-id=\"123\"></salla-offer>\n */\n@Component({\n  tag: 'salla-offer',\n  styleUrl: 'salla-offer.scss',\n})\nexport class SallaOffer {\n\n  constructor() {\n    // Language\n    salla.lang.onLoaded(() => {\n      this.offer_with_price_text = salla.lang.get('pages.offer.with_price');\n      this.with_discount_text = salla.lang.get('pages.products.with_a_discount');\n      this.product_discount_text = salla.lang.get('pages.products.discount');\n      this.special_offer_text = salla.lang.get('pages.products.special_offer');\n      this.buy_quantity_text(\"\");\n    })\n\n    salla.onReady(() => {\n      //let's make our component smart by getting the product id from the config if it's not passed\n      this.productId = this.productId || (salla.url.is_page('product.single') ? salla.config.get('page.id') : null)\n      this.userCurrency = salla.config.get('user.currency');\n    });\n\n    this.categorySlot = this.host.querySelector('[slot=\"category\"]')?.innerHTML || '<a href={url} class=\"s-offer-slide-cat-entry\"><i class={icon}></i><h4>{name}</h4></a>';\n  }\n\n\n  /**\n   * Product id with the special offer tobe fetched.\n   */\n  @Prop({ mutable: true, reflect: true }) productId: number;\n\n  // Declare component state variables\n  @State() offer: Offer;\n  @State() offersList: Offer[] = [];\n  @State() userCurrency: Currency;\n  @State() isMultipleBank: boolean;\n  @State() title?: string;\n\n  // Default translated texts\n  @State() offer_with_price_text: string = salla.lang.get('pages.offer.with_price', { price: '' });\n  @State() with_discount_text: string = salla.lang.get('pages.products.with_a_discount')\n  @State() product_discount_text: string = salla.lang.get('pages.products.discount')\n  @State() special_offer_text: string = salla.lang.get('pages.products.special_offer')\n  @State() buy_quantity_text: (quantity: string) => string = (quantity) => salla.lang.get('pages.offer.buy_quantity', { quantity })\n\n  // Reference to the host element\n  @Element() host: HTMLElement;\n\n  private categorySlot: string;\n\n  /**\n   * Generates content for the categories section.\n   *\n   * @param offeredCategories - An array of Category objects.\n   * @returns An array of HTML elements representing categories.\n   */\n  private getCategoriesSection(offeredCategories: Category[]) {\n    return offeredCategories.map((category: Category) => {\n      return <div class=\"s-offer-slide-one-sixth swiper-slide\" innerHTML={this.categorySlot\n        .replace(/\\{url\\}/g, category.url)\n        .replace(/\\{icon\\}/g, category.icon)\n        .replace(/\\{name\\}/g, category.name)}></div>\n    })\n  }\n\n  /**\n   * Generates content for the products section.\n   *\n   * @param offeredProducts - An array of Product objects.\n   * @returns An array of HTML elements representing products.\n   */\n  private getProductSection(offeredProducts: Product[]) {\n    return offeredProducts.map((product: Product) =>\n      <div class=\"s-offer-slide-one-fourth\">\n        <salla-product-card shadow-on-hover product={product}></salla-product-card>\n      </div>\n    )\n  }\n\n  /**\n   * Generates content for the bank section.\n   *\n   * @param offeredBank - An array of Bank objects.\n   * @param name - The title of the current offer.\n   * @param description - The description of the current offer.\n   * @returns An array of HTML elements representing banks.\n   */\n  private getBankSection(offeredBank: Bank[], name: string, description: string) {\n    return offeredBank.map((bank: Bank) =>\n      <div class={{ \"s-offer-slide-one-sixth\": this.isMultipleBank, \"s-offer-bank-wrapper-sinlge-item\": !this.isMultipleBank }}>\n        <div class={{ \"s-offer-bank-wrapper\": true, \"s-offer-slide-one-sixth\": !this.isMultipleBank, \"s-offer-bank-wrapper-multi-spacer\": this.isMultipleBank }}>\n          <div class=\"s-offer-bank-logo\">\n            <img src={bank.logo || salla.url.cdn('images/s-empty.png')} data-src={bank.logo} alt={bank.name + \" offer\"} />\n          </div>\n          <ul class=\"s-offer-bank-payment-wrapper\">\n            {bank.payments.map((payment: Payment) => {\n              return <li class=\"s-offer-bank-payment-single\">\n                <img\n                  src={salla.url.cdn('images/payment/' + payment + '_mini.png') || salla.url.cdn('images/s-empty.png')}\n                  data-src={salla.url.cdn('images/payment/' + payment + '_mini.png')}\n                  alt=\"payment\" />\n              </li>\n            })}\n          </ul>\n          {this.isMultipleBank ?\n            <p class=\"s-offer-bank-payment-discount-percent\">\n              {this.product_discount_text + bank.percent}%\n            </p>\n            : \"\"}\n        </div>\n        {!this.isMultipleBank ?\n          <div class=\"s-offer-bank-message s-offer-slide-one-fourth\">\n            <h2>{name}</h2>\n            <p>{description}</p>\n          </div>\n          : \"\"}\n      </div>\n    )\n  }\n\n  /**\n   * Generates content for the discount table section.\n   *\n   * @param discountTable - An array of Discount objects.\n   * @returns An array of HTML elements representing discounts_table.\n   */\n  private getDiscountTableSection(discountTable: Discount[]) {\n    return discountTable.map((discount: Discount) => {\n      return <div class=\"s-offer-slide-one-fourth\">\n        <div class=\"s-offer-slide-offer-entry\">\n          <div class=\"s-offer-slide-offer-entry-price-quantity-container\">\n            <p class=\"s-offer-slide-offer-entry-quantity\">{this.buy_quantity_text(discount.quantity_text)}</p>\n            {discount.show_discounted_price ?\n              <div class=\"s-offer-slide-offer-entry-price\">\n                <span>{this.offer_with_price_text}</span>\n                <span class=\"s-offer-slide-offer-entry-price-amount\">{salla.helpers.money(discount.price)}</span> {this.userCurrency?.symbol}\n              </div> : \"\"}\n          </div>\n          <p class=\"s-offer-slide-offer-entry-price-amount-percent\">{this.with_discount_text}\n            (<span>{discount.percent}</span>)</p>\n        </div>\n      </div>\n    })\n  }\n\n  render() {\n    if (!this.productId) {\n      salla.logger.error('salla-offer::Can\\'t render the component without product-id!');\n      return;\n    }\n    if (!this.offersList.length) return null;\n    const offer: Offer = this.offersList[0];\n    this.isMultipleBank = !!offer && !!offer.get.banks && offer.get.banks.length > 1;\n    return (\n      <div class=\"s-offer-wrapper\">\n        <p class=\"s-offer-corner-badge\">{this.special_offer_text}</p>\n        <salla-slider\n          type=\"carousel\"\n          block-title={this.isMultipleBank ? offer.name : null}\n          block-subTitle={this.isMultipleBank ? offer.message : null}\n          id=\"offer-slider\">\n          <div slot='items'>\n            {\n              [!!offer.get.categories ? this.getCategoriesSection(offer.get.categories) :\n                !!offer.get.products ? this.getProductSection(offer.get.products) :\n                  !!offer.get.banks ? this.getBankSection(offer.get.banks, offer.name, offer.message) : '',\n              !!offer.get.discounts_table ?\n                this.getDiscountTableSection(offer.get.discounts_table) :\n                \"\"]}\n          </div>\n        </salla-slider>\n      </div>\n    );\n  }\n\n  componentWillLoad() {\n    return this.productId\n      ? salla.api.product.offers(this.productId).then(resp =>\n        this.offersList = resp.data\n      )\n      : null\n  }\n\n}\n"],"mappings":"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"}