{"version":3,"names":["sallaOfferCss","SallaOffer","constructor","hostRef","salla","lang","get","price","quantity","onLoaded","this","offer_with_price_text","with_discount_text","product_discount_text","special_offer_text","buy_quantity_text","onReady","productId","url","is_page","config","userCurrency","categorySlot","_a","host","querySelector","innerHTML","getCategoriesSection","offeredCategories","map","category","h","class","replace","icon","name","getProductSection","offeredProducts","product","getBankSection","offeredBank","description","bank","isMultipleBank","src","logo","cdn","alt","payments","payment","percent","getDiscountTableSection","discountTable","discount","quantity_text","show_discounted_price","helpers","money","symbol","render","logger","error","offersList","length","offer","banks","type","message","id","slot","categories","products","discounts_table","componentWillLoad","api","offers","then","resp","data"],"sources":["src/components/salla-offer/salla-offer.scss?tag=salla-offer","src/components/salla-offer/salla-offer.tsx"],"sourcesContent":[".s-offer-wrapper .s-slider-block__title {\n  h2 {\n    font-size: 1.125rem;\n    line-height: 1.75rem;\n    color: #f87171;\n\n    &::before {\n      font-family: \"sallaicons\";\n      content: \"\\ee30\" !important;\n      position: absolute;\n      top: 1rem;\n      font-size: 3rem;\n      font-weight: 400;\n      line-height: 1;\n      color: #fef2f2;\n    }\n  }\n}\n\n.s-offer-bank-wrapper-sinlge-item{\n    display: flex;\n    align-items: center !important;\n    gap: 14px;\n}\n\n.s-offer-bank-wrapper {\n  display: flex !important;\n  width: 100% !important;\n}\n\n// .s-offer-bank-wrapper {\n  // \n// }","import { Component, Element, Prop, State, h } from '@stencil/core';\nimport { Offer, Category, Product, Discount, Currency, Bank, Payment } from \"./interfaces\"\n\n\n/**\n * `salla-offer` is a StencilJS component that displays offers, categories, products, banks, and discount information.\n * It uses the `salla-slider` component for carousel functionality.\n *\n * @slot category - The slot for customizing the category entry layout.\n * \n * @csspart custom - Custom CSS part to target specific elements in the component.\n *\n * @example\n * <salla-offer product-id=\"123\"></salla-offer>\n */\n@Component({\n  tag: 'salla-offer',\n  styleUrl: 'salla-offer.scss',\n})\nexport class SallaOffer {\n\n  constructor() {\n    // Language\n    salla.lang.onLoaded(() => {\n      this.offer_with_price_text = salla.lang.get('pages.offer.with_price');\n      this.with_discount_text = salla.lang.get('pages.products.with_a_discount');\n      this.product_discount_text = salla.lang.get('pages.products.discount');\n      this.special_offer_text = salla.lang.get('pages.products.special_offer');\n      this.buy_quantity_text(\"\");\n    })\n\n    salla.onReady(() => {\n      //let's make our component smart by getting the product id from the config if it's not passed\n      this.productId = this.productId || (salla.url.is_page('product.single') ? salla.config.get('page.id') : null)\n      this.userCurrency = salla.config.get('user.currency');\n    });\n\n    this.categorySlot = this.host.querySelector('[slot=\"category\"]')?.innerHTML || '<a href={url} class=\"s-offer-slide-cat-entry\"><i class={icon}></i><h4>{name}</h4></a>';\n  }\n\n\n  /**\n   * Product id with the special offer tobe fetched.\n   */\n  @Prop({ mutable: true, reflect: true }) productId: number;\n\n  // Declare component state variables\n  @State() offer: Offer;\n  @State() offersList: Offer[] = [];\n  @State() userCurrency: Currency;\n  @State() isMultipleBank: boolean;\n  @State() title?: string;\n\n  // Default translated texts\n  @State() offer_with_price_text: string = salla.lang.get('pages.offer.with_price', { price: '' });\n  @State() with_discount_text: string = salla.lang.get('pages.products.with_a_discount')\n  @State() product_discount_text: string = salla.lang.get('pages.products.discount')\n  @State() special_offer_text: string = salla.lang.get('pages.products.special_offer')\n  @State() buy_quantity_text: (quantity: string) => string = (quantity) => salla.lang.get('pages.offer.buy_quantity', { quantity })\n\n  // Reference to the host element\n  @Element() host: HTMLElement;\n\n  private categorySlot: string;\n\n  /**\n   * Generates content for the categories section.\n   *\n   * @param offeredCategories - An array of Category objects.\n   * @returns An array of HTML elements representing categories.\n   */\n  private getCategoriesSection(offeredCategories: Category[]) {\n    return offeredCategories.map((category: Category) => {\n      return <div class=\"s-offer-slide-one-sixth swiper-slide\" innerHTML={this.categorySlot\n        .replace(/\\{url\\}/g, category.url)\n        .replace(/\\{icon\\}/g, category.icon)\n        .replace(/\\{name\\}/g, category.name)}></div>\n    })\n  }\n\n  /**\n   * Generates content for the products section.\n   *\n   * @param offeredProducts - An array of Product objects.\n   * @returns An array of HTML elements representing products.\n   */\n  private getProductSection(offeredProducts: Product[]) {\n    return offeredProducts.map((product: Product) =>\n      <div class=\"s-offer-slide-one-fourth\">\n        <salla-product-card shadow-on-hover product={product}></salla-product-card>\n      </div>\n    )\n  }\n\n  /**\n   * Generates content for the bank section.\n   *\n   * @param offeredBank - An array of Bank objects.\n   * @param name - The title of the current offer.\n   * @param description - The description of the current offer.\n   * @returns An array of HTML elements representing banks.\n   */\n  private getBankSection(offeredBank: Bank[], name: string, description: string) {\n    return offeredBank.map((bank: Bank) =>\n      <div class={{ \"s-offer-slide-one-sixth\": this.isMultipleBank, \"s-offer-bank-wrapper-sinlge-item\": !this.isMultipleBank }}>\n        <div class={{ \"s-offer-bank-wrapper\": true, \"s-offer-slide-one-sixth\": !this.isMultipleBank, \"s-offer-bank-wrapper-multi-spacer\": this.isMultipleBank }}>\n          <div class=\"s-offer-bank-logo\">\n            <img src={bank.logo || salla.url.cdn('images/s-empty.png')} data-src={bank.logo} alt={bank.name + \" offer\"} />\n          </div>\n          <ul class=\"s-offer-bank-payment-wrapper\">\n            {bank.payments.map((payment: Payment) => {\n              return <li class=\"s-offer-bank-payment-single\">\n                <img\n                  src={salla.url.cdn('images/payment/' + payment + '_mini.png') || salla.url.cdn('images/s-empty.png')}\n                  data-src={salla.url.cdn('images/payment/' + payment + '_mini.png')}\n                  alt=\"payment\" />\n              </li>\n            })}\n          </ul>\n          {this.isMultipleBank ?\n            <p class=\"s-offer-bank-payment-discount-percent\">\n              {this.product_discount_text + bank.percent}%\n            </p>\n            : \"\"}\n        </div>\n        {!this.isMultipleBank ?\n          <div class=\"s-offer-bank-message s-offer-slide-one-fourth\">\n            <h2>{name}</h2>\n            <p>{description}</p>\n          </div>\n          : \"\"}\n      </div>\n    )\n  }\n\n  /**\n   * Generates content for the discount table section.\n   *\n   * @param discountTable - An array of Discount objects.\n   * @returns An array of HTML elements representing discounts_table.\n   */\n  private getDiscountTableSection(discountTable: Discount[]) {\n    return discountTable.map((discount: Discount) => {\n      return <div class=\"s-offer-slide-one-fourth\">\n        <div class=\"s-offer-slide-offer-entry\">\n          <div class=\"s-offer-slide-offer-entry-price-quantity-container\">\n            <p class=\"s-offer-slide-offer-entry-quantity\">{this.buy_quantity_text(discount.quantity_text)}</p>\n            {discount.show_discounted_price ?\n              <div class=\"s-offer-slide-offer-entry-price\">\n                <span>{this.offer_with_price_text}</span>\n                <span class=\"s-offer-slide-offer-entry-price-amount\">{salla.helpers.money(discount.price)}</span> {this.userCurrency?.symbol}\n              </div> : \"\"}\n          </div>\n          <p class=\"s-offer-slide-offer-entry-price-amount-percent\">{this.with_discount_text}\n            (<span>{discount.percent}</span>)</p>\n        </div>\n      </div>\n    })\n  }\n\n  render() {\n    if (!this.productId) {\n      salla.logger.error('salla-offer::Can\\'t render the component without product-id!');\n      return;\n    }\n    if (!this.offersList.length) return null;\n    const offer: Offer = this.offersList[0];\n    this.isMultipleBank = !!offer && !!offer.get.banks && offer.get.banks.length > 1;\n    return (\n      <div class=\"s-offer-wrapper\">\n        <p class=\"s-offer-corner-badge\">{this.special_offer_text}</p>\n        <salla-slider\n          type=\"carousel\"\n          block-title={this.isMultipleBank ? offer.name : null}\n          block-subTitle={this.isMultipleBank ? offer.message : null}\n          id=\"offer-slider\">\n          <div slot='items'>\n            {\n              [!!offer.get.categories ? this.getCategoriesSection(offer.get.categories) :\n                !!offer.get.products ? this.getProductSection(offer.get.products) :\n                  !!offer.get.banks ? this.getBankSection(offer.get.banks, offer.name, offer.message) : '',\n              !!offer.get.discounts_table ?\n                this.getDiscountTableSection(offer.get.discounts_table) :\n                \"\"]}\n          </div>\n        </salla-slider>\n      </div>\n    );\n  }\n\n  componentWillLoad() {\n    return this.productId\n      ? salla.api.product.offers(this.productId).then(resp =>\n        this.offersList = resp.data\n      )\n      : null\n  }\n\n}\n"],"mappings":"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"}