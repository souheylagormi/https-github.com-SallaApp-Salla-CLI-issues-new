{"version":3,"names":["DisplayType","Currency","sallaProductOptionsCss","SallaProductOptions","exports","class_1","hostRef","_this","this","fileTypes","pdf","png","jpg","word","exl","txt","outSkus","handleDonationOptions","event","detail","type","salla","helpers","inputDigitsOnly","target","emit","id","productId","price","value","preventDefault","stopPropagation","isCustomDonation","donationInput","focus","hideLabel","option","DONATION","donation","can_donate","getExpireDonationMessage","completed","target_amount","collected_amount","h","class","target_message","money","lang","get","getWithDefault","config","canDisabled","onLoaded","outOfStockText","donationAmount","selectDonationAmount","selectAmount","options","setOptionsData","Array","isArray","JSON","parse","e","log","optionsData","url","is_page","api","product","getDetails","then","resp","data","prototype","that","_b","_a","details","forEach","Object","entries","skus_availability","filter","sku","map","push","Number","getSelectedOptionsData","selectedOptions","formData","host","getElementSallaData","key","startsWith","replace","reportValidity","requiredElements","querySelectorAll","pass","i","length","hasOutOfStockOption","some","is_out","selectedSkus","every","includes","getSelectedOptions","getOption","option_id","find","invalidHandler","closestProductOption","closest","scrollIntoView","behavior","block","classList","add","changedHandler","optionElement","FILE","IMAGE","MAP","lat","lng","setTimeout","remove","index","findIndex","assign","setSelectedSkus","handleRequiredMultipleOptions","changed","keys","reduce","p","c","MULTIPLE_OPTIONS","required","optionContainer","querySelector","concat","hasChecked","input","toggleAttribute","getLatLng","split","getDisplayForType","COLOR_PICKER","colorPickerOption","multipleOptions","SINGLE_OPTION","singleOption","getOptionShownWhen","visibility_condition","operator","componentWillLoad","cart","getCurrentCartId","componentDidRender","selectedDonationOption","is_selected","additional_price","render","Host","name","splitterOption","htmlFor","placeholder","donationOption","checked","onChange","custom_amount_enabled","shown","ref","el","onInput","onBlur","onInvalid","currency","symbol","fileUploader","additions","height","onAdded","getUploadImageEndpoint","cart_item_id","product_id","onInvalidInput","innerHTML","accept","CameraIcon","FileIcon","imageOption","fileOption","types","Boolean","join","numberOption","textOption","textareaOption","rows","mapOption","zoom","searchable","onSelected","onSubmitted","color","timeOption","noCalendar","enableTime","dateFormat","onPicked","dateOption","minDate","Date","datetimeOption","maxDate","to_date_time","from_date_time","getOptionDetailName","outOfStock","optionType","COLOR","isOptionDetailOut","isDetailSelected","outSelectableSkus_1","disabled","selected","is_required","colorOption","style","thumbnailOption","option_value","image","src","title","alt","CheckCircleIcon"],"sources":["src/components/salla-product-options/interfaces.ts","src/components/salla-product-options/salla-product-options.scss?tag=salla-product-options","src/components/salla-product-options/salla-product-options.tsx"],"sourcesContent":["export enum DisplayType {\n  COLOR = \"color\",\n  DATE = \"date\",\n  DATETIME = \"datetime\",\n  DONATION = \"donation\",\n  IMAGE = \"image\",\n  MULTIPLE_OPTIONS = \"multiple-options\",\n  NUMBER = \"number\",\n  SINGLE_OPTION = \"single-option\",\n  SPLITTER = \"splitter\",\n  TEXT = \"text\",\n  TEXTAREA = \"textarea\",\n  THUMBNAIL = \"thumbnail\",\n  TIME = \"time\",\n  RADIO = \"radio\",\n  CHECKBOX = \"checkbox\",\n  MAP = \"map\",\n  FILE = \"file\", // similar to image type (file-uploader component)\n  COLOR_PICKER = \"color_picker\"\n\n}\n\nexport interface ProductDetail {\n  id: string;\n  sku: string;\n  name: string;\n  description: string;\n  url: string;\n  promotion_title: string;\n  subtitle: string;\n  type: string;\n  status: string;\n  price: number;\n  sale_price: number;\n  regular_price: number;\n  starting_price: null;\n  quantity: number;\n  max_quantity: number;\n  discount_ends: number;\n  is_taxable: boolean;\n  has_read_more: boolean;\n  can_add_note: boolean;\n  can_show_remained_quantity: boolean;\n  can_upload_file: boolean;\n  has_custom_form: boolean;\n  is_on_sale: boolean;\n  is_hidden_quantity: boolean;\n  is_available: boolean;\n  is_out_of_stock: boolean;\n  weight: null;\n  calories: null;\n  image: SimpleImage;\n  brand: Brand;\n  donation?: ProductDonation;\n  images: Image[];\n  tags: Tag[];\n  notify_availability: null;\n  rating: Rating;\n  options: Option[];\n  sold_quantity: number;\n  category: Category;\n}\n\nexport interface SimpleImage {\n  url: string;\n  alt: string;\n}\n\nexport interface Category {\n  name: string;\n  url: string;\n  icon: string;\n}\n\nexport interface ProductDonation {\n  target_message?: string;\n  collected_amount?: number;\n  target_amount?: number;\n  target_percent?: number;\n  target_end_date?: string;\n  can_donate: boolean;\n  custom_amount_enabled: boolean;\n}\n\nexport interface Image {\n  id: number;\n  url: string;\n  main: boolean;\n  three_d_image_url: string;\n  alt: string;\n  video_url: string;\n  type: string;\n  sort: number;\n}\n\nexport interface Option {\n  id: number;\n  name: string;\n  required: boolean;\n  type: string;\n  placeholder: string;\n  option_type: string;\n  not_same_day_order: boolean;\n  availability_range: number;\n  from_date_time: null;\n  to_date_time: null;\n  visibility_condition?: { option: number, operator: \"=\" | \"!=\", value: number };\n  details?: Detail[];\n  condition_attributes: string;\n  value?: any;\n  donation?: Donation\n}\n\nexport interface Donation {\n  custom_amount_enabled: boolean;\n  target_message?: string;\n  target_date: string | \"2023-04-18\";\n  target_end_date: string | \"2023-04-18\";\n  target_amount: number;\n  collected_amount: number;\n  can_donate: boolean;\n}\n\nexport interface Detail {\n  id: number;\n  option_id: number;\n  name: string;\n  additional_price: number;\n  option_value: null | string;\n  image: null | string;\n  color: null | string;\n  is_out: boolean;\n  skus_availability?: { [sku_id: number]: boolean };\n  is_selected: boolean;\n}\n\nexport interface Brand {\n  id: string;\n  url: string;\n  name: string;\n  logo: string;\n}\n\nexport interface PreTaxPrice {\n  amount: number;\n  currency: Currency;\n}\n\nexport enum Currency {\n  Sar = \"SAR\",\n}\n\nexport interface Promotion {\n  title: string;\n  sub_title: string;\n}\n\nexport interface Rating {\n  count: number;\n  stars: number;\n}\n\nexport interface Tag {\n  name: string;\n  url: string;\n}\n","\n.s-product-options{\n  &-wrapper{\n\n  }\n  &-option-container{\n\n  }\n  &-option{\n\n  }\n  &-option-label{\n\n  }\n  &-option-content{\n\n  }\n  &-colors-wrapper{\n\n  }\n  &-date-element{\n\n  }\n  &-time-element{\n    \n  }\n  &-datetime-element{\n\n  }\n  &-image-input{\n\n  }\n  &-multiple-options-wrapper{\n\n  }\n  &-splitter{\n\n  }\n  &-text{\n\n  }\n  &-textarea{\n\n  }\n  &-thumbnails-wrapper{\n\n  }\n}","import { Component, Prop, h, State, Element, Host, Event, EventEmitter, Method } from '@stencil/core';\nimport { Option, DisplayType, Detail } from './interfaces';\nimport CheckCircleIcon from '../../assets/svg/check.svg';\nimport CameraIcon from '../../assets/svg/camera.svg';\nimport FileIcon from '../../assets/svg/file-upload.svg';\n\n\n@Component({\n  tag: 'salla-product-options',\n  styleUrl: 'salla-product-options.scss',\n})\nexport class SallaProductOptions {\n\n  constructor() {\n    this.canDisabled = !salla.config.get('store.settings.products.notify_options_availability');\n    salla.lang.onLoaded(() => {\n      this.outOfStockText = salla.lang.get(\"pages.products.out_of_stock\");\n      this.donationAmount = salla.lang.get('pages.products.donation_amount');\n      this.selectDonationAmount = salla.lang.getWithDefault('pages.products.select_donation_amount', 'تحديد مبلغ التبرع');\n      this.selectAmount = salla.lang.getWithDefault('pages.products.select_amount', 'اختر المبلغ');\n    });\n\n    if (this.options) {\n      try {\n        this.setOptionsData(Array.isArray(this.options) ? this.options : JSON.parse(this.options));\n        return;\n      } catch (e) {\n        salla.log('Bad json passed via options prop');\n      }\n    }\n    if (!Array.isArray(this.optionsData)) {\n      salla.log('Options is not an array[] ---> ', this.optionsData);\n      this.setOptionsData([]);\n    }\n\n    if (this.productId && !salla.url.is_page('cart')) {\n      salla.api.product.getDetails(this.productId, ['options']).then(resp => this.setOptionsData(resp.data.options));\n    }\n  }\n\n  private setOptionsData(optionsData: Option[]) {\n    this.optionsData = optionsData;\n    let that = this\n    this.optionsData[0]?.details?.forEach(function (detail) {\n      Object.entries(detail.skus_availability || {})\n        .filter(sku => !sku[1])\n        .map(sku => that.outSkus.push(Number(sku[0])));\n    });\n  }\n\n  @Element() host: HTMLElement;\n\n  private fileTypes: Object = {\n    pdf: 'application/pdf',\n    png: 'image/png',\n    jpg: 'image/jpeg',\n    word: 'application/doc,application/ms-doc,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    exl: 'application/excel,application/vnd.ms-excel,application/x-excel,application/x-msexcel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    txt: 'text/plain',\n  };\n\n  @State() optionsData: Option[];\n  @State() outOfStockText: string = ''\n  @State() donationAmount: string = salla.lang.get('pages.products.donation_amount')\n  @State() selectDonationAmount: string = salla.lang.getWithDefault('pages.products.select_donation_amount', 'تحديد مبلغ التبرع')\n  @State() selectAmount: string = salla.lang.getWithDefault('pages.products.select_amount', 'اختر المبلغ')\n  @State() isCustomDonation: boolean = false;\n  @State() selectedOptions: Array<any> = [];\n  @State() canDisabled: boolean;\n  @State() selectedSkus?: Array<string | number>;\n  @State() selectedOutSkus?: Array<string | number>;\n  private outSkus: Array<string | number> = [];\n  private donationInput?: HTMLInputElement;\n\n  /**\n   * The id of the product to which the options are going to be fetched for.\n   */\n  @Prop() productId: number = salla.config.get('page.id');\n\n  /**\n   * Product detail information.\n   */\n  @Prop() options: string;\n\n  /**\n   * Get the id's of the selected options.\n   * */\n  @Method()\n  async getSelectedOptionsData() {\n    let selectedOptions = {}\n    let formData = (this.host as any).getElementSallaData();\n    formData.forEach(function (value, key) {\n      key.startsWith('options[') && (selectedOptions[key.replace('options[', '').replace(']', '')] = value);\n    });\n    return selectedOptions;\n  }\n\n  /**\n   * Report options form validity.\n   * */\n  @Method()\n  async reportValidity() {\n    let requiredElements: Array<HTMLInputElement> = this.host.querySelectorAll('[required]') as any;\n    let pass = true;\n    for (let i = 0; i < requiredElements.length; i++) {\n      //if there is only one invalid option, return false\n      if ('reportValidity' in requiredElements[i] && !requiredElements[i].reportValidity()) {\n        pass = false;\n      }\n    }\n    return pass;\n  }\n\n  /**\n   * Return true if there is any out of stock options are selected and vise versa.\n   * */\n  @Method()\n  async hasOutOfStockOption() {\n    return this.selectedOptions.some(option => option.is_out) || (this.selectedSkus?.length && this.selectedSkus?.every(sku => this.outSkus.includes(sku)));\n  }\n\n  /**\n   * Get selected options.\n   * */\n  @Method()\n  async getSelectedOptions() {\n    return this.selectedOptions;\n  }\n\n  /**\n   * Get a specific option by its id.\n   * */\n  @Method()\n  async getOption(option_id) {\n    return this.optionsData.find(option => option.id === option_id);\n  }\n\n  /**\n   * An event that emitted when any option is changed.\n   */\n  @Event() changed: EventEmitter;\n\n  // @ts-ignore\n  private invalidHandler(event, option: Option) {\n    const closestProductOption = (event.target as HTMLInputElement).closest('.s-product-options-option') as HTMLElement;\n    if (!salla.url.is_page('cart')) {\n      closestProductOption.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }\n    closestProductOption.classList.add('s-product-options-option-error');\n  }\n\n  private changedHandler(event, option) {\n    let data = { event: event, option: option, detail: null };\n    if (option.details) {\n      let detail = option.details.find((detail) => {\n        return Number(detail.id) === Number(event.target.value);\n      });\n      data.detail = detail\n    }\n\n    let optionElement = event.target.closest('.s-product-options-option');\n    if (event.target.value\n      || ((option.type == DisplayType.FILE || option.type == DisplayType.IMAGE) && event.type === 'added')\n      || (option.type == DisplayType.MAP && event.type === 'selected' && (event.target.lat && event.target.lng))) {\n      setTimeout(() => {\n        optionElement.classList.remove('s-product-options-option-error');\n      }, 200);\n    }\n\n    const index = this.selectedOptions.findIndex(option => option.option_id === data.option.id);\n    index > -1 ? this.selectedOptions[index] = {\n      ...data.detail,\n      option_id: data.option.id\n    } : this.selectedOptions.push({ ...data.detail, option_id: data.option.id })\n\n    if (option.type == DisplayType.DONATION) {\n      salla.event.emit('product-options::donation-changed', {\n        id: this.productId,\n        price: event.target.value\n      });\n    }\n    this.setSelectedSkus();\n    this.handleRequiredMultipleOptions(option);\n    this.changed.emit(data);\n    salla.event.emit('product-options::change', data);\n  }\n\n\n  private handleDonationOptions = (event, detail, type) => {\n    if (detail == 'custom' && type == 'input') {\n      salla.helpers.inputDigitsOnly(event.target)\n      salla.event.emit('product-options::donation-changed', {\n        id: this.productId,\n        price: event.target.value\n      });\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    this.isCustomDonation = event.target.value === 'custom';\n    if (this.donationInput) {\n      if (event.target.value === 'custom') {\n        this.donationInput.value = '';\n        this.donationInput.focus()\n      } else {\n        this.donationInput.value = event.target.value;\n      }\n      if (detail == 'custom') {\n        return\n      }\n      salla.event.emit('product-options::donation-changed', {\n        id: this.productId,\n        price: event.target.value\n      });\n    }\n  }\n\n  private hideLabel = (option) => {\n    if (option.type === DisplayType.DONATION && (option.donation && !option.donation.can_donate)) {\n      return true;\n    }\n    return false;\n  }\n\n  private getExpireDonationMessage = (option) => {\n    if (!option.donation) {\n      return;\n    }\n    let completed = option.donation.target_amount <= option.donation.collected_amount;\n    return <div class={{ \"s-product-options-donation-message\": true, \"s-product-options-donation-completed\": completed, \"s-product-options-donation-expired\": !completed }}>\n      <p>{option.donation.target_message}</p>\n      <span>{completed ? salla.money(option.donation.target_amount) : ''}</span>\n    </div>\n  }\n  /**\n   * loop throw all selected details, then get common sku, if it's only one, means we selected all of them;\n   */\n  private setSelectedSkus() {\n    this.selectedSkus = this.selectedOptions.map(detail => Object.keys(detail.skus_availability || {}))\n      .reduce((p, c) => p.filter(e => c.includes(e)))\n      .map(sku => Number(sku));\n  }\n\n  private handleRequiredMultipleOptions(option) {\n    if (option.type !== DisplayType.MULTIPLE_OPTIONS || !option.required) {\n      return;\n    }\n    const optionContainer = this.host.querySelector(`[data-option-id=\"${option.id}\"]`);\n    const hasChecked = optionContainer.querySelectorAll('input:checked').length;\n    optionContainer.querySelectorAll('input').forEach(input => input.toggleAttribute('required', !hasChecked));\n  }\n\n  private getLatLng(value, type: 'lat' | 'lng') {\n    return value\n      ? value.split(',')[type == 'lat' ? 0 : 1]\n      : '';\n  }\n\n  private getDisplayForType(option: Option) {\n    if (this[`${option.type}Option`]) {\n      return this[`${option.type}Option`](option);\n    }\n\n    if (option.type === DisplayType.COLOR_PICKER) {\n      return this.colorPickerOption(option)\n    }\n\n    if (option.type === DisplayType.MULTIPLE_OPTIONS) {\n      return this.multipleOptions(option);\n    }\n\n    if (option.type === DisplayType.SINGLE_OPTION) {\n      return this.singleOption(option);\n    }\n    salla.log(`Couldn't find options type(${option.type})😢`);\n    return '';\n  }\n\n  protected getOptionShownWhen(option: Option) {\n    return option.visibility_condition\n      ? { \"data-show-when\": `options[${option.visibility_condition.option}] ${option.visibility_condition.operator} ${option.visibility_condition.value}` }\n      : {};\n  }\n\n  //we need the cart Id for productOption Image\n  componentWillLoad() {\n    this.outOfStockText = salla.lang.get('pages.products.out_of_stock')\n    return salla.api.cart.getCurrentCartId();\n  }\n\n  componentDidRender() {\n      if (this.optionsData?.length == 0 && !this.optionsData.some(option => option.type == DisplayType.DONATION)) {\n        return;\n      }\n      let selectedDonationOption =  this.optionsData.find(option => option.type == DisplayType.DONATION)?.details.find(detail => detail.is_selected);\n      if (!selectedDonationOption) {\n        return;\n      }\n      setTimeout(() => {\n        salla.event.emit('product-options::donation-changed', {\n          id: this.productId,\n          price: selectedDonationOption.additional_price\n        });\n      }, 1000);\n  }\n\n  render() {\n    if (this.optionsData?.length == 0) {\n      return;\n    }\n\n    return (\n      <Host class=\"s-product-options-wrapper\">\n        {/* TODO:: move salla-conditional-field logic to here, no need of another component*/}\n        <salla-conditional-fields>\n          {this.optionsData.map((option: Option) =>\n            <div class={`s-product-options-option-container${option.visibility_condition ? ' hidden' : ''}`}\n              data-option-id={option.id}\n              {...this.getOptionShownWhen(option)}>\n              {option.name == 'splitter' ?\n                this.splitterOption()\n                : <div class=\"s-product-options-option\" data-option-type={option.type}\n                  data-option-required={`${option.required}`}>\n                  <label htmlFor={'options[' + option.id + ']'} class={`s-product-options-option-label ${this.hideLabel(option) ? 's-product-options-option-label-hidden' : ''}`}>\n                    <b>\n                      {option.name}\n                      {option.required && <span> * </span>} </b>\n                    <small>{option.placeholder}</small>\n                  </label>\n                  <div class={`s-product-options-option-content ${this.hideLabel(option) ? 's-product-options-option-content-full-width' : ''}`}>\n                    {this.getDisplayForType(option)}\n                  </div>\n                </div>}\n            </div>\n          )}\n        </salla-conditional-fields>\n      </Host>\n    );\n\n  }\n\n  //@ts-ignore\n  private donationOption(option: Option, product: Product) {\n    return <div class=\"s-product-options-donation-wrapper\">\n\n      {option.donation?.can_donate ? [\n        option.donation ?\n          <div class=\"s-product-options-donation-progress\">\n            <salla-progress-bar donation={option.donation}>\n            </salla-progress-bar>\n          </div>\n          : '',\n        option.details.length ?\n          [<h4>{this.selectAmount}</h4>,\n          <div class=\"s-product-options-donation-options\">\n            {option.details.map((detail, i) =>\n              <div class=\"s-product-options-donation-options-item\">\n                <input id={`donation-option-${i}`} type=\"radio\" name=\"donating_option\" checked={detail.is_selected} value={detail.additional_price} onChange={e => this.handleDonationOptions(e, detail, 'option')} />\n                <label htmlFor={`donation-option-${i}`}>\n                  <span>{salla.money(detail.name)}</span>\n                </label>\n              </div>\n            )}\n            {option.donation?.custom_amount_enabled ?\n              <div class=\"s-product-options-donation-options-item\">\n                <input id={`donation-option-custom`} type=\"radio\" name=\"donating_option\" value=\"custom\" onChange={e => this.handleDonationOptions(e, 'custom', 'option')} />\n                <label htmlFor={`donation-option-custom`}>\n                  <span> {this.selectDonationAmount} </span>\n                </label>\n              </div>\n              : ''\n            }\n          </div>] : '',\n\n        <div class={{ \"s-product-options-donation-input-group\": true, \"shown\": !option.details.length || (option.details.length && this.isCustomDonation) }}>\n          <input\n            type=\"text\"\n            id=\"donating-amount\"\n            name=\"donation_amount\"\n            class=\"s-form-control\"\n            ref={el => this.donationInput = el as HTMLInputElement}\n            value={\n              option.details.length\n                && option.details.some(detail => detail.is_selected)\n                ? option.details.find(detail => detail.is_selected).additional_price\n                : option.value}\n            // required\n            placeholder={option.placeholder}\n            onInput={e => this.handleDonationOptions(e, 'custom', 'input')}\n            onBlur={e => this.changedHandler(e, option)}\n            onInvalid={(e) => this.invalidHandler(e, option)}\n          />\n          {/* value={option.value} */}\n          <span class=\"s-product-options-donation-amount-currency\">\n            {salla.config.currency(salla.config.get('user.currency_code')).symbol}\n          </span>\n        </div>\n      ] :\n        this.getExpireDonationMessage(option)\n      }\n    </div>\n  }\n\n  private fileUploader(option: Option, additions: Object | null = null) {\n    return <salla-file-upload\n      {...(additions || {})}\n      payload-name=\"file\"\n      value={option.value}\n      instant-upload={true}\n      name={`options[${option.id}]`}\n      required={!option.visibility_condition && option.required}\n      height=\"120px\"\n      onAdded={(e) => this.changedHandler(e, option)}\n      url={salla.cart.api.getUploadImageEndpoint()}\n      form-data={{ cart_item_id: this.productId, product_id: this.productId }}\n      onInvalidInput={(e) => this.invalidHandler(e, option)}\n      class={{ \"s-product-options-image-input\": true, required: option.required }}\n    >\n      <div class=\"s-product-options-filepond-placeholder\">\n        <span class=\"s-product-options-filepond-placeholder-icon\"\n          innerHTML={(additions as any).accept && (additions as any).accept.split(',').every(type => type.includes('image'))\n            ? CameraIcon\n            : FileIcon}\n        />\n        <p class=\"s-product-options-filepond-placeholder-text\">{salla.lang.get('common.uploader.drag_and_drop')}</p>\n        <span class=\"filepond--label-action\">{salla.lang.get('common.uploader.browse')}</span>\n      </div>\n    </salla-file-upload>\n  }\n\n  //@ts-ignore\n  private imageOption(option: Option) {\n    return this.fileUploader(option, { accept: 'image/png,image/jpeg,image/jpg,image/gif' });\n  }\n\n  //@ts-ignore\n  private fileOption(option: Option) {\n    let types = option.details.map(detail => this.fileTypes[detail.name]).filter(Boolean);\n    return types?.length\n      ? this.fileUploader(option, { accept: types.join(',') })\n      : 'File types not selected.';\n  }\n\n  // TODO: (ONLY FOR TESTING!) find a better way to make it testable, e.g. wrap it with a unique class like textOption\n  //@ts-ignore\n  private numberOption(option: Option) {\n    return <input\n      type=\"text\"\n      value={option.value}\n      class=\"s-form-control\"\n      required={!option.visibility_condition && option.required}\n      name={`options[${option.id}]`}\n      placeholder={option.placeholder}\n      onBlur={e => this.changedHandler(e, option)}\n      onInvalid={(e) => this.invalidHandler(e, option)}\n      onInput={e => salla.helpers.inputDigitsOnly(e.target)} />\n  }\n\n  //@ts-ignore\n  private splitterOption() {\n    return <div class=\"s-product-options-splitter\" />\n  }\n\n  //@ts-ignore\n  private textOption(option: Option) {\n    return <div class=\"s-product-options-text\">\n      <input\n        type=\"text\"\n        value={option.value}\n        class='s-form-control'\n        required={!option.visibility_condition && option.required}\n        name={`options[${option.id}]`}\n        placeholder={option.placeholder}\n        onInvalid={(e) => this.invalidHandler(e, option)}\n        onInput={e => this.changedHandler(e, option)} />\n    </div>\n  }\n\n  //@ts-ignore\n  private textareaOption(option: Option) {\n    //todo::remove mt-1 class, and if it's okay to remove the tag itself will be great\n    return <div class=\"s-product-options-textarea\">\n      <div class=\"mt-1\">\n        <textarea\n          rows={4}\n          value={option.value}\n          class=\"s-form-control\"\n          required={!option.visibility_condition && option.required}\n          id={`options[${option.id}]`}\n          name={`options[${option.id}]`}\n          placeholder={option.placeholder}\n          onInvalid={(e) => this.invalidHandler(e, option)}\n          onInput={(e) => this.changedHandler(e, option)} />\n      </div>\n    </div>\n  }\n\n  //@ts-ignore\n  private mapOption(option: Option) {\n    return <salla-map\n      zoom={15}\n      lat={this.getLatLng(option.value, 'lat')}\n      lng={this.getLatLng(option.value, 'lng')}\n      name={`options[${option.id}]`}\n      searchable={true}\n      required={option.required}\n      onInvalidInput={(e) => this.invalidHandler(e, option)}\n      onSelected={e => this.changedHandler(e, option)} />\n  }\n\n  private colorPickerOption(option: Option) {\n    return <salla-color-picker\n      onSubmitted={e => this.changedHandler(e, option)}\n      name={`options[${option.id}]`}\n      required={!option.visibility_condition && option.required}\n      onInvalidInput={(e) => this.invalidHandler(e, option)}\n      color={option.value} />\n  }\n\n  /**\n   * ============= Date Time options =============\n   */\n  //@ts-ignore\n  private timeOption(option: Option) {\n    return <salla-datetime-picker\n      noCalendar={true}\n      enableTime={true}\n      dateFormat=\"h:i K\"\n      value={option.value}\n      placeholder={option.name}\n      required={!option.visibility_condition && option.required}\n      name={`options[${option.id}]`}\n      class=\"s-product-options-time-element\"\n      onInvalidInput={(e) => this.invalidHandler(e, option)}\n      onPicked={e => this.changedHandler(e, option)} />\n  }\n\n  //@ts-ignore\n  private dateOption(option: Option) {\n    //todo:: consider date-range @see https://github.com/SallaApp/theme-raed/blob/master/src/assets/js/partials/product-options.js#L8-L23\n    return <div class=\"s-product-options-date-element\">\n      <salla-datetime-picker\n        value={option.value}\n        placeholder={option.name}\n        required={!option.visibility_condition && option.required}\n        minDate={new Date()}\n        name={`options[${option.id}]`}\n        onInvalidInput={(e) => this.invalidHandler(e, option)}\n        onPicked={e => this.changedHandler(e, option)} />\n    </div>\n  }\n\n  //@ts-ignore\n  private datetimeOption(option: Option) {\n    //todo:: consider date-range @see https://github.com/SallaApp/theme-raed/blob/master/src/assets/js/partials/product-options.js#L8-L23\n    return <div class=\"s-product-options-datetime-element\">\n      <salla-datetime-picker\n        enableTime={true}\n        value={option.value}\n        dateFormat=\"Y-m-d G:i:K\"\n        placeholder={option.name}\n        required={!option.visibility_condition && option.required}\n        name={`options[${option.id}]`}\n        maxDate={option.to_date_time}\n        minDate={option.from_date_time}\n        onInvalidInput={(e) => this.invalidHandler(e, option)}\n        onPicked={e => this.changedHandler(e, option)} />\n    </div>\n  }\n\n  /**\n   * ============= Advanced options =============\n   */\n  protected getOptionDetailName(detail: Detail, outOfStock: boolean = true, optionType?: string) {\n    if (optionType && optionType == DisplayType.COLOR) {\n      return detail.name\n        + ((outOfStock && this.isOptionDetailOut(detail)) ? ` <br/> <p> ${this.outOfStockText} </p>` : '')\n        + (detail.additional_price ? ` <p> (${salla.money(detail.additional_price)}) </p>` : '');\n    }\n\n    return detail.name\n      + ((outOfStock && this.isOptionDetailOut(detail)) ? ` - ${this.outOfStockText}` : '')\n      + (detail.additional_price ? ` (${salla.money(detail.additional_price)})` : '');\n  }\n\n\n  protected isOptionDetailOut(detail: Detail) {\n    if (detail.is_out || !detail.skus_availability || !this.selectedSkus?.length) {\n      return detail.is_out;\n    }\n\n    let isDetailSelected = this.selectedOptions.filter(option => option.id == detail.id).length;\n    //if the current options is the only selected option, so we are sure that it's not out, because there is no other options selected yet\n    if (isDetailSelected && this.selectedOptions.length == 1) {\n      return false;\n    }\n\n    //if current details has sku in the possible outSkus it's out for sure\n    if (isDetailSelected) {\n      //here we will get the possible outSkus for current selected options\n      let outSelectableSkus = this.selectedSkus.filter(sku => this.outSkus.includes(sku));\n      return Object.keys(detail.skus_availability).some(sku => outSelectableSkus.includes(Number(sku)))\n    }\n\n    return this.selectedOptions.some(option => option.is_out && option.option_id !== detail.option_id)\n\n  }\n\n  private singleOption(option: Option) {\n    return <div>\n      <select name={`options[${option.id}]`}\n        required={!option.visibility_condition && option.required}\n        class=\"s-form-control\"\n        onInvalid={(e) => this.invalidHandler(e, option)}\n        onChange={e => this.changedHandler(e, option)}>\n        <option value=\"\">{option.placeholder}</option>\n        {\n          option?.details.map((detail: Detail) => {\n            return <option value={detail.id} disabled={this.canDisabled && this.isOptionDetailOut(detail)}\n              selected={detail.is_selected}>\n              {this.getOptionDetailName(detail)}\n            </option>\n          })\n        }\n      </select>\n    </div>\n  }\n\n  private multipleOptions(option: Option) {\n    let is_required = option.required && !option.details.some(detail => detail.is_selected) && !option.visibility_condition;\n    return <div class={{ \"s-product-options-multiple-options-wrapper\": true, 'required': option.required }}>\n      {\n        option?.details.map((detail: Detail) => {\n          return <div>\n            <input type=\"checkbox\"\n              value={detail.id}\n              disabled={this.isOptionDetailOut(detail)}\n              checked={detail.is_selected}\n              required={is_required}\n              name={`options[${option.id}][]`}\n              id={`field-${option.id}-${detail.id}`}\n              onChange={(e) => this.changedHandler(e, option)}\n              onInvalid={(e) => this.invalidHandler(e, option)}\n              aria-describedby={`options[${option.id}]-description`} />\n            <label htmlFor={`field-${option.id}-${detail.id}`}>{this.getOptionDetailName(detail)}</label>\n          </div>\n        })\n      }\n    </div>\n  }\n\n  //@ts-ignore\n  private colorOption(option: Option) {\n    return <fieldset class=\"s-product-options-colors-wrapper\">\n      {\n        option?.details.map((detail) =>\n          <div class=\"s-product-options-colors-item\">\n            <input type=\"radio\"\n              value={detail.id}\n              required={!option.visibility_condition && option.required}\n              checked={detail.is_selected}\n              name={`options[${option.id}]`}\n              disabled={this.canDisabled && this.isOptionDetailOut(detail)}\n              id={`color-${this.productId}-${option.id}-${detail.id}`}\n              onInvalid={(e) => this.invalidHandler(e, option)}\n              onChange={e => this.changedHandler(e, option)} />\n            <label htmlFor={`color-${this.productId}-${option.id}-${detail.id}`}>\n              <span style={{ \"background-color\": detail.color }} />\n              <div innerHTML={this.getOptionDetailName(detail, true, option.type)}></div>\n            </label>\n          </div>\n        )\n      }\n    </fieldset>\n  }\n\n  //@ts-ignore\n  private thumbnailOption(option: Option) {\n    return <div class=\"s-product-options-thumbnails-wrapper\">\n      {option.details.map((detail: Detail) => {\n        return <div>\n          <input type=\"radio\"\n            value={detail.id}\n            data-itemid={detail.id} //todo:: why need this? it's already in the value!\n            required={!option.visibility_condition && option.required}\n            checked={detail.is_selected}\n            name={`options[${option.id}]`}\n            data-img-id={detail.option_value}\n            disabled={this.canDisabled && this.isOptionDetailOut(detail)}\n            id={`option_${this.productId}-${option.id}_${detail.id}`}\n            onInvalid={(e) => this.invalidHandler(e, option)}\n            onChange={(e) => this.changedHandler(e, option)} />\n          <label htmlFor={`option_${this.productId}-${option.id}_${detail.id}`}\n            data-img-id={detail.option_value}\n            class=\"go-to-slide\">\n            <img data-src={detail.image} src={detail.image} title={detail.name} alt={detail.name} />\n            <span innerHTML={CheckCircleIcon} class=\"s-product-options-thumbnails-icon\" />\n            {this.isOptionDetailOut(detail) ?\n              [\n                <small class=\"s-product-options-thumbnails-stock-badge\">{this.outOfStockText}</small>,\n                this.canDisabled ? <div class=\"s-product-options-thumbnails-badge-overlay\" /> : '',\n              ]\n              : ''}\n          </label>\n          <p>{this.getOptionDetailName(detail, false)} </p>\n        </div>\n      })}\n    </div>\n  }\n}\n"],"mappings":"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"}