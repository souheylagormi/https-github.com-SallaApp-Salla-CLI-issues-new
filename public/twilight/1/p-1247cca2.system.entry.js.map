{"version":3,"names":["sallaAppInstallAlertCss","SallaAppInstallAlert","exports","salla","config","get","class_1","prototype","connectedCallback","_this","this","onReady","data","isMobileOrTabletDevice","ctaLink","getMobileOS","setTimeout","open","ua","navigator","userAgent","test","document","screen","screenWidth","window","innerWidth","userAgentCheck","hasTouch","maxTouchPoints","closeAlert","storage","set","closing","host","addEventListener","once","render","h","Host","class","concat","position","src","icon","width","height","alt","title","sub_title","href","target","lang","getWithDefault","onClick"],"sources":["src/components/salla-app-install-alert/salla-app-install-alert.scss?tag=salla-app-install-alert","src/components/salla-app-install-alert/salla-app-install-alert.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Component, h, State, Element, Host } from '@stencil/core';\n\n@Component({\n  tag: 'salla-app-install-alert',\n  styleUrl: 'salla-app-install-alert.scss',\n})\nexport class SallaAppInstallAlert {\n  connectedCallback() {\n    salla.onReady(() => {\n      this.data = salla.config.get('store.app_install_prompt');\n      if (!this.isMobileOrTabletDevice()) {\n        return;\n      }\n\n      this.ctaLink = salla.config.get('store.apps')[this.getMobileOS() === 'iOS' ? 'appstore' : 'googleplay'];\n      setTimeout(() => (this.open = true), 3000);\n    });\n  }\n  @State() data: any = salla.config.get('store.app_install_prompt');\n  @State() ctaLink: string;\n  @State() open: boolean = false;\n  @State() closing: boolean = false;\n  @Element() private host: HTMLElement;\n\n\n\n  /**\n   * Get the OS of device (android/ios).\n   * @returns {string} returns iOS/Android/Other\n   */\n  private getMobileOS(): string {\n    const ua = navigator.userAgent;\n    if (/android/i.test(ua)) {\n      return 'Android';\n    } else if (\n      /iPad|iPhone|iPod/.test(ua) ||\n      (/Macintosh/i.test(navigator.userAgent) && 'ontouchend' in document)\n    ) {\n      return 'iOS';\n    }\n    return 'Other';\n  }\n\n  /**\n   * Check if the website opens from mobile or tablet devices only (android/ios).\n   *\n   * @param {number} screen the width of the biggest screen to be checked\n   * @returns {boolean} true if it is mobile or tablet else false\n   */\n  private isMobileOrTabletDevice(screen = 1024): boolean {\n    const screenWidth = window.innerWidth <= screen;\n    const userAgentCheck = /Macintosh|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n    const hasTouch =\n      'ontouchstart' in window ||\n      'ontouchend' in document ||\n      navigator.maxTouchPoints > 0;\n\n    return userAgentCheck && screenWidth && hasTouch;\n  }\n\n  closeAlert() {\n    salla.storage.set('app_install_prompt_disabled', true);\n    // handle closing animation first, then close the banner\n    this.closing = true;\n    this.host.addEventListener(\n      'animationend',\n      () => {\n        this.closing = false\n        this.open = false;\n      },\n      { once: true }\n    );\n  }\n\n\n  render() {\n    return (\n      <Host class={`s-app-install-alert-wrapper ${this.open ? 'open' : ''} ${this.closing ? 'closing' : ''}`} position={this.data.position}>\n        <div>\n          <img src={this.data.icon} width=\"58\" height=\"58\" alt={`${salla.config.get('store.name')}`} />\n        </div>\n        <div class=\"s-app-install-alert-content\">\n          <h2 class=\"s-app-install-alert-title\">{this.data.title}</h2>\n          <p class=\"s-app-install-alert-sub-title\">\n            {this.data.sub_title} {\" \"}\n            <a href={this.ctaLink} target=\"_blank\" aria-label=\"download app\" class=\"s-app-install-alert-cta\">\n              {salla.lang.getWithDefault('blocks.footer.download_app_now', 'حمله الآن')}\n            </a>\n          </p>\n        </div>\n        <button class=\"s-app-install-alert-cancel-button\" onClick={() => this.closeAlert()}>\n          <i class=\"sicon-cancel\"></i>\n        </button>\n      </Host>\n    );\n  }\n}\n"],"mappings":";;;0JAAA,IAAMA,EAA0B,uB,ICMnBC,EAAoBC,EAAA,qC,kCAYVC,MAAMC,OAAOC,IAAI,4B,iCAEb,M,aACG,K,CAd5BC,EAAAC,UAAAC,kBAAA,eAAAC,EAAAC,KACEP,MAAMQ,SAAQ,WACZF,EAAKG,KAAOT,MAAMC,OAAOC,IAAI,4BAC7B,IAAKI,EAAKI,yBAA0B,CAClC,M,CAGFJ,EAAKK,QAAUX,MAAMC,OAAOC,IAAI,cAAcI,EAAKM,gBAAkB,MAAQ,WAAa,cAC1FC,YAAW,kBAAOP,EAAKQ,KAAO,IAAnB,GAA0B,I,KAejCX,EAAAC,UAAAQ,YAAA,WACN,IAAMG,EAAKC,UAAUC,UACrB,GAAI,WAAWC,KAAKH,GAAK,CACvB,MAAO,S,MACF,GACL,mBAAmBG,KAAKH,IACvB,aAAaG,KAAKF,UAAUC,YAAc,eAAgBE,SAC3D,CACA,MAAO,K,CAET,MAAO,O,EASDhB,EAAAC,UAAAM,uBAAA,SAAuBU,GAAA,GAAAA,SAAA,GAAAA,EAAA,IAAa,CAC1C,IAAMC,EAAcC,OAAOC,YAAcH,EACzC,IAAMI,EAAiB,sCAAsCN,KAAKF,UAAUC,WAC5E,IAAMQ,EACJ,iBAAkBH,QAClB,eAAgBH,UAChBH,UAAUU,eAAiB,EAE7B,OAAOF,GAAkBH,GAAeI,C,EAG1CtB,EAAAC,UAAAuB,WAAA,eAAArB,EAAAC,KACEP,MAAM4B,QAAQC,IAAI,8BAA+B,MAEjDtB,KAAKuB,QAAU,KACfvB,KAAKwB,KAAKC,iBACR,gBACA,WACE1B,EAAKwB,QAAU,MACfxB,EAAKQ,KAAO,K,GAEd,CAAEmB,KAAM,M,EAKZ9B,EAAAC,UAAA8B,OAAA,eAAA5B,EAAAC,KACE,OACE4B,EAACC,EAAI,CAACC,MAAO,+BAAAC,OAA+B/B,KAAKO,KAAO,OAAS,GAAE,KAAAwB,OAAI/B,KAAKuB,QAAU,UAAY,IAAMS,SAAUhC,KAAKE,KAAK8B,UAC1HJ,EAAA,WACEA,EAAA,OAAKK,IAAKjC,KAAKE,KAAKgC,KAAMC,MAAM,KAAKC,OAAO,KAAKC,IAAK,GAAAN,OAAGtC,MAAMC,OAAOC,IAAI,kBAE5EiC,EAAA,OAAKE,MAAM,+BACTF,EAAA,MAAIE,MAAM,6BAA6B9B,KAAKE,KAAKoC,OACjDV,EAAA,KAAGE,MAAM,iCACN9B,KAAKE,KAAKqC,UAAS,IAAG,IACvBX,EAAA,KAAGY,KAAMxC,KAAKI,QAASqC,OAAO,SAAQ,aAAY,eAAeX,MAAM,2BACpErC,MAAMiD,KAAKC,eAAe,iCAAkC,gBAInEf,EAAA,UAAQE,MAAM,oCAAoCc,QAAS,WAAM,OAAA7C,EAAKqB,YAAL,GAC/DQ,EAAA,KAAGE,MAAM,kB,yHArFc,I"}