{"version":3,"names":["sallaFiltersWidgetCss","SallaFiltersWidget","exports","this","initHeight","salla","config","get","class_1","prototype","connectedCallback","_this","withLoadMore","option","key","Array","isArray","values","length","onReady","page","lang","onLoaded","showMoreLabel","getWithDefault","showLessLabel","componentDidLoad","widgetValues","scrollHeight","style","maxHeight","concat","widgetContent","height","setWidgetHeight","delay","removeAttribute","setTimeout","currentWidgetHeight","offsetHeight","reset","type","FilterOptionTypes","RANGE","priceRange","from","host","querySelectorAll","forEach","input","checked","showMore","isShowMore","toggleWidget","isOpen","Helper","toggleElementClassIf","renderFilterOption","VALUES","MINIMUM","VARIANTS","includes","map","filterOption","index","value","h","class","htmlFor","id","name","isSelectedOption","onChange","e","changed","emit","event","getOptionLabel","filtersData","Object","keys","min","max","Number","size","label","render","Host","onClick","ref","el","onChanged","detail","price"],"sources":["src/components/salla-filters-widget/salla-filters-widget.scss?tag=salla-filters-widget","src/components/salla-filters-widget/salla-filters-widget.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Component, Host, h, Method, State, Prop, Event, Element } from '@stencil/core';\nimport Helper from '../../Helpers/Helper';\nimport { Filter, FilterOptionTypes } from \"../salla-filters/interfaces\";\n\n@Component({\n  tag: 'salla-filters-widget',\n  styleUrl: 'salla-filters-widget.scss',\n})\nexport class SallaFiltersWidget {\n  @Element() host: HTMLElement;\n\n  /**\n   * Show more or less filter options.\n   */\n  @Prop({ mutable: true }) withLoadMore: boolean;\n\n  /**\n   * Selected filter options value.\n   */\n  @Prop({ reflect: true }) filtersData: object;\n\n  /**\n   * Filter option along with possible values.\n   */\n  @Prop({ reflect: true }) option: Filter;\n\n\n  priceRange: HTMLSallaPriceRangeElement\n\n\n  private widgetValues: HTMLElement;\n  private widgetContent: HTMLDivElement;\n  private initHeight: number = 195;\n\n  @State() isOpen: boolean = true;\n  @State() isShowMore: boolean = false;\n  @State() showMoreLabel: string = \"عرض المزيد\";\n  @State() showLessLabel: string = \"عرض أقل\";\n  @State() page: any = salla.config.get('page');\n\n  /**\n   * Custom event emitted up on filter option selection changes.\n   */\n  @Event() changed: any;\n\n  connectedCallback() {\n    //lets be smart and don't show 5 and more link for 8 options\n    this.withLoadMore = this.option.key != 'price' && Array.isArray(this.option.values) && this.option.values.length > 8;\n    salla.onReady(() => {\n      this.page = salla.config.get('page');\n    })\n    salla.lang.onLoaded(() => {\n      this.showMoreLabel = salla.lang.getWithDefault('common.titles.more', this.showMoreLabel)\n      this.showLessLabel = salla.lang.getWithDefault('common.elements.show_less', this.showLessLabel)\n    })\n  }\n\n  componentDidLoad() {\n    this.widgetValues.scrollHeight < this.initHeight && (this.withLoadMore = false);\n    (this.withLoadMore && this.widgetValues) && (this.widgetValues.style.maxHeight = `${this.initHeight}px`);\n    this.widgetContent.style.height = `${this.widgetContent.scrollHeight}px`;\n  }\n\n  /**\n * Asynchronously sets the height of a widget element to its current height, allowing for smooth transitions.\n * This function is often used in scenarios where the widget's content changes dynamically, and animating\n * the height adjustment is desired for a smoother user experience.\n *\n * @param {number} [delay=250] - Optional. The delay (in milliseconds) before updating the widget height.\n *                               Defaults to 250 milliseconds.\n *\n * @returns {Promise<void>} - A Promise that resolves once the widget height is set after the specified delay.\n *\n * @example\n * // Set widget height with the default delay (250 milliseconds)\n * await setWidgetHeight();\n *\n * // Set widget height with a custom delay (e.g., 500 milliseconds)\n * await setWidgetHeight(500);\n */\n  @Method()\n  async setWidgetHeight(delay = 250) {\n    this.widgetContent.removeAttribute('style');\n    setTimeout(() => {\n      let currentWidgetHeight: number = this.widgetContent.offsetHeight;\n      this.widgetContent.style.height = currentWidgetHeight + 'px';\n    }, delay)\n  }\n\n  /**\n   * Reset selected filter options.\n   */\n  @Method()\n  async reset() {\n    if (this.option.type === FilterOptionTypes.RANGE) {\n      this.priceRange.reset()\n    }\n    Array.from(this.host.querySelectorAll('input')).forEach(input => input.checked = false);\n  }\n\n\n  /**\n   * Action to show more or less filter options.\n   */\n  @Method()\n  async showMore() {\n    this.isShowMore = !this.isShowMore\n    this.widgetContent.style.height = 'auto';\n    this.widgetValues.style.maxHeight = this.isShowMore ? `${this.widgetValues.scrollHeight}px` : `${this.initHeight}px`;\n    setTimeout(() => {\n      this.widgetContent.style.height = `${this.widgetContent.scrollHeight}px`;\n    }, 400); // get height after time of collapse animtion (duration-300)\n  }\n\n  /**\n   * Action to toggle widget open or closed (expand/ collapse).\n   */\n  @Method()\n  async toggleWidget() {\n    this.isOpen = !this.isOpen;\n    Helper.toggleElementClassIf(this.widgetContent, 's-filters-widget-opened', 's-filters-widget-closed', () => this.isOpen);\n  }\n\n  renderFilterOption(option: Filter) {\n    if (![FilterOptionTypes.VALUES, FilterOptionTypes.MINIMUM, FilterOptionTypes.VARIANTS].includes(option.type)) {\n      return '';\n    }\n    //@ts-ignore\n    return option.values.map((filterOption, index) => {\n      let value = typeof filterOption == 'number' ? filterOption : (filterOption.key || filterOption.value);\n      return <label class=\"s-filters-label\" htmlFor={`${option.key}-option-${index}`}>\n        <input\n          id={`${option.key}-option-${index}`}\n          name={option.key}\n          type=\"radio\"\n          checked={this.isSelectedOption(option, value)}\n          class={`s-filters-radio`}\n          onChange={e => this.changed.emit({ event: e, option: option, value: value })}\n        />\n        {this.getOptionLabel(option, filterOption)}\n      </label>\n    }\n    )\n\n  }\n  private isSelectedOption(option: Filter, value: any): boolean {\n    if (option.type === FilterOptionTypes.MINIMUM) {\n      return this.filtersData[option.key] == value;\n    }\n    if (option.type === FilterOptionTypes.VARIANTS) {\n      return this.filtersData[option.type] && this.filtersData[option.type][Object.keys(this.filtersData[option.type])[0]] == value;\n    }\n    if (option.type === FilterOptionTypes.RANGE) {\n      return this.filtersData[option.key] && this.filtersData[option.key].min == value.min && this.filtersData[option.key].max == value.max;\n    }\n\n    if (option.type === FilterOptionTypes.VALUES) {\n      return this.filtersData[option.key] && Number(this.filtersData[option.key]) == Number(value);\n    }\n    return false;\n  }\n\n\n\n  private getOptionLabel(option: Filter, filterOption) {\n    if (option.key == 'rating') {\n      //in amazon has stars & up, should we add it, to avoid those people who will come to say I selected 4 why I see 5 sars products\n      return <salla-rating-stars size=\"small\" value={filterOption} />;\n    }\n    let label = filterOption.value || 'null';\n    //label+=filterOption.count ? ` (${salla.helpers.number(filterOption.count)})` : '';\n    return <span class=\"s-filters-option-name\">{label}</span>;\n  }\n\n  render() {\n    return (\n      <Host class=\"s-filters-widget-container\">\n        <h3 class=\"s-filters-widget-title\" onClick={() => this.toggleWidget()}>\n          <span>{this.option.label}</span>\n          <span class={`s-filters-widget-plusminus ${this.isOpen ? 's-filters-widget-plusminus-active' : ''}`} />\n        </h3>\n        <div class=\"s-filters-widget-content\" ref={(el) => this.widgetContent = el}>\n          <div class=\"s-filters-widget-values\" ref={(el) => this.widgetValues = el}>\n            <slot />\n            {\n              this.option.type !== FilterOptionTypes.RANGE\n                ? this.renderFilterOption(this.option)\n                : <salla-price-range onChanged={(event) => this.changed.emit(event.detail)}\n                  ref={price => this.priceRange = price}\n                  filtersData={this.filtersData}\n                  option={this.option} />\n            }\n          </div>\n          {this.withLoadMore &&\n            <a class=\"s-filters-widget-more\"\n              onClick={() => this.showMore()}>{!this.isShowMore ? this.showMoreLabel : this.showLessLabel}</a>\n          }\n        </div>\n      </Host>\n    );\n  }\n\n}\n"],"mappings":";;;iQAAA,IAAMA,EAAwB,uB,ICQjBC,EAAkBC,EAAA,kC,yDAwBrBC,KAAAC,WAAqB,I,yFAEF,K,gBACI,M,mBACE,a,mBACA,U,UACZC,MAAMC,OAAOC,IAAI,O,CAOtCC,EAAAC,UAAAC,kBAAA,eAAAC,EAAAR,KAEEA,KAAKS,aAAeT,KAAKU,OAAOC,KAAO,SAAWC,MAAMC,QAAQb,KAAKU,OAAOI,SAAWd,KAAKU,OAAOI,OAAOC,OAAS,EACnHb,MAAMc,SAAQ,WACZR,EAAKS,KAAOf,MAAMC,OAAOC,IAAI,O,IAE/BF,MAAMgB,KAAKC,UAAS,WAClBX,EAAKY,cAAgBlB,MAAMgB,KAAKG,eAAe,qBAAsBb,EAAKY,eAC1EZ,EAAKc,cAAgBpB,MAAMgB,KAAKG,eAAe,4BAA6Bb,EAAKc,c,KAIrFjB,EAAAC,UAAAiB,iBAAA,WACEvB,KAAKwB,aAAaC,aAAezB,KAAKC,aAAeD,KAAKS,aAAe,OACxET,KAAKS,cAAgBT,KAAKwB,eAAkBxB,KAAKwB,aAAaE,MAAMC,UAAY,GAAAC,OAAG5B,KAAKC,WAAU,OACnGD,KAAK6B,cAAcH,MAAMI,OAAS,GAAAF,OAAG5B,KAAK6B,cAAcJ,aAAY,K,EAqBhEpB,EAAAC,UAAAyB,gBAAN,SAAsBC,GAAA,GAAAA,SAAA,GAAAA,EAAA,GAAW,C,gGAC/BhC,KAAK6B,cAAcI,gBAAgB,SACnCC,YAAW,WACT,IAAIC,EAA8B3B,EAAKqB,cAAcO,aACrD5B,EAAKqB,cAAcH,MAAMI,OAASK,EAAsB,I,GACvDH,G,iBAOC3B,EAAAC,UAAA+B,MAAN,W,qFACE,GAAIrC,KAAKU,OAAO4B,OAASC,EAAkBC,MAAO,CAChDxC,KAAKyC,WAAWJ,O,CAElBzB,MAAM8B,KAAK1C,KAAK2C,KAAKC,iBAAiB,UAAUC,SAAQ,SAAAC,GAAS,OAAAA,EAAMC,QAAU,KAAhB,I,iBAQ7D1C,EAAAC,UAAA0C,SAAN,W,gGACEhD,KAAKiD,YAAcjD,KAAKiD,WACxBjD,KAAK6B,cAAcH,MAAMI,OAAS,OAClC9B,KAAKwB,aAAaE,MAAMC,UAAY3B,KAAKiD,WAAa,GAAArB,OAAG5B,KAAKwB,aAAaC,aAAY,MAAO,GAAAG,OAAG5B,KAAKC,WAAU,MAChHiC,YAAW,WACT1B,EAAKqB,cAAcH,MAAMI,OAAS,GAAAF,OAAGpB,EAAKqB,cAAcJ,aAAY,K,GACnE,K,iBAOCpB,EAAAC,UAAA4C,aAAN,W,gGACElD,KAAKmD,QAAUnD,KAAKmD,OACpBC,EAAOC,qBAAqBrD,KAAK6B,cAAe,0BAA2B,2BAA2B,WAAM,OAAArB,EAAK2C,MAAL,I,iBAG9G9C,EAAAC,UAAAgD,mBAAA,SAAmB5C,GAAnB,IAAAF,EAAAR,KACE,IAAK,CAACuC,EAAkBgB,OAAQhB,EAAkBiB,QAASjB,EAAkBkB,UAAUC,SAAShD,EAAO4B,MAAO,CAC5G,MAAO,E,CAGT,OAAO5B,EAAOI,OAAO6C,KAAI,SAACC,EAAcC,GACtC,IAAIC,SAAeF,GAAgB,SAAWA,EAAgBA,EAAajD,KAAOiD,EAAaE,MAC/F,OAAOC,EAAA,SAAOC,MAAM,kBAAkBC,QAAS,GAAArC,OAAGlB,EAAOC,IAAG,YAAAiB,OAAWiC,IACrEE,EAAA,SACEG,GAAI,GAAAtC,OAAGlB,EAAOC,IAAG,YAAAiB,OAAWiC,GAC5BM,KAAMzD,EAAOC,IACb2B,KAAK,QACLS,QAASvC,EAAK4D,iBAAiB1D,EAAQoD,GACvCE,MAAO,kBACPK,SAAU,SAAAC,GAAK,OAAA9D,EAAK+D,QAAQC,KAAK,CAAEC,MAAOH,EAAG5D,OAAQA,EAAQoD,MAAOA,GAArD,IAEhBtD,EAAKkE,eAAehE,EAAQkD,G,KAM3BvD,EAAAC,UAAA8D,iBAAA,SAAiB1D,EAAgBoD,GACvC,GAAIpD,EAAO4B,OAASC,EAAkBiB,QAAS,CAC7C,OAAOxD,KAAK2E,YAAYjE,EAAOC,MAAQmD,C,CAEzC,GAAIpD,EAAO4B,OAASC,EAAkBkB,SAAU,CAC9C,OAAOzD,KAAK2E,YAAYjE,EAAO4B,OAAStC,KAAK2E,YAAYjE,EAAO4B,MAAMsC,OAAOC,KAAK7E,KAAK2E,YAAYjE,EAAO4B,OAAO,KAAOwB,C,CAE1H,GAAIpD,EAAO4B,OAASC,EAAkBC,MAAO,CAC3C,OAAOxC,KAAK2E,YAAYjE,EAAOC,MAAQX,KAAK2E,YAAYjE,EAAOC,KAAKmE,KAAOhB,EAAMgB,KAAO9E,KAAK2E,YAAYjE,EAAOC,KAAKoE,KAAOjB,EAAMiB,G,CAGpI,GAAIrE,EAAO4B,OAASC,EAAkBgB,OAAQ,CAC5C,OAAOvD,KAAK2E,YAAYjE,EAAOC,MAAQqE,OAAOhF,KAAK2E,YAAYjE,EAAOC,OAASqE,OAAOlB,E,CAExF,OAAO,K,EAKDzD,EAAAC,UAAAoE,eAAA,SAAehE,EAAgBkD,GACrC,GAAIlD,EAAOC,KAAO,SAAU,CAE1B,OAAOoD,EAAA,sBAAoBkB,KAAK,QAAQnB,MAAOF,G,CAEjD,IAAIsB,EAAQtB,EAAaE,OAAS,OAElC,OAAOC,EAAA,QAAMC,MAAM,yBAAyBkB,E,EAG9C7E,EAAAC,UAAA6E,OAAA,eAAA3E,EAAAR,KACE,OACE+D,EAACqB,EAAI,CAACpB,MAAM,8BACVD,EAAA,MAAIC,MAAM,yBAAyBqB,QAAS,WAAM,OAAA7E,EAAK0C,cAAL,GAChDa,EAAA,YAAO/D,KAAKU,OAAOwE,OACnBnB,EAAA,QAAMC,MAAO,8BAAApC,OAA8B5B,KAAKmD,OAAS,oCAAsC,OAEjGY,EAAA,OAAKC,MAAM,2BAA2BsB,IAAK,SAACC,GAAO,OAAA/E,EAAKqB,cAAgB0D,CAArB,GACjDxB,EAAA,OAAKC,MAAM,0BAA0BsB,IAAK,SAACC,GAAO,OAAA/E,EAAKgB,aAAe+D,CAApB,GAChDxB,EAAA,aAEE/D,KAAKU,OAAO4B,OAASC,EAAkBC,MACnCxC,KAAKsD,mBAAmBtD,KAAKU,QAC7BqD,EAAA,qBAAmByB,UAAW,SAACf,GAAU,OAAAjE,EAAK+D,QAAQC,KAAKC,EAAMgB,OAAxB,EACzCH,IAAK,SAAAI,GAAS,OAAAlF,EAAKiC,WAAaiD,CAAlB,EACdf,YAAa3E,KAAK2E,YAClBjE,OAAQV,KAAKU,UAGpBV,KAAKS,cACJsD,EAAA,KAAGC,MAAM,wBACPqB,QAAS,WAAM,OAAA7E,EAAKwC,UAAL,IAAmBhD,KAAKiD,WAAajD,KAAKoB,cAAgBpB,KAAKsB,gB,yHA3L7D,I"}