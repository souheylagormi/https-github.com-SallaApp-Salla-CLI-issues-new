{"version":3,"names":["sallaAppInstallAlertCss","SallaAppInstallAlert","salla","config","get","connectedCallback","onReady","this","data","isMobileOrTabletDevice","ctaLink","getMobileOS","setTimeout","open","ua","navigator","userAgent","test","document","screen","screenWidth","window","innerWidth","userAgentCheck","hasTouch","maxTouchPoints","closeAlert","storage","set","closing","host","addEventListener","once","render","h","Host","class","position","src","icon","width","height","alt","title","sub_title","href","target","lang","getWithDefault","onClick"],"sources":["src/components/salla-app-install-alert/salla-app-install-alert.scss?tag=salla-app-install-alert","src/components/salla-app-install-alert/salla-app-install-alert.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Component, h, State, Element, Host } from '@stencil/core';\n\n@Component({\n  tag: 'salla-app-install-alert',\n  styleUrl: 'salla-app-install-alert.scss',\n})\nexport class SallaAppInstallAlert {\n  connectedCallback() {\n    salla.onReady(() => {\n      this.data = salla.config.get('store.app_install_prompt');\n      if (!this.isMobileOrTabletDevice()) {\n        return;\n      }\n\n      this.ctaLink = salla.config.get('store.apps')[this.getMobileOS() === 'iOS' ? 'appstore' : 'googleplay'];\n      setTimeout(() => (this.open = true), 3000);\n    });\n  }\n  @State() data: any = salla.config.get('store.app_install_prompt');\n  @State() ctaLink: string;\n  @State() open: boolean = false;\n  @State() closing: boolean = false;\n  @Element() private host: HTMLElement;\n\n\n\n  /**\n   * Get the OS of device (android/ios).\n   * @returns {string} returns iOS/Android/Other\n   */\n  private getMobileOS(): string {\n    const ua = navigator.userAgent;\n    if (/android/i.test(ua)) {\n      return 'Android';\n    } else if (\n      /iPad|iPhone|iPod/.test(ua) ||\n      (/Macintosh/i.test(navigator.userAgent) && 'ontouchend' in document)\n    ) {\n      return 'iOS';\n    }\n    return 'Other';\n  }\n\n  /**\n   * Check if the website opens from mobile or tablet devices only (android/ios).\n   *\n   * @param {number} screen the width of the biggest screen to be checked\n   * @returns {boolean} true if it is mobile or tablet else false\n   */\n  private isMobileOrTabletDevice(screen = 1024): boolean {\n    const screenWidth = window.innerWidth <= screen;\n    const userAgentCheck = /Macintosh|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n    const hasTouch =\n      'ontouchstart' in window ||\n      'ontouchend' in document ||\n      navigator.maxTouchPoints > 0;\n\n    return userAgentCheck && screenWidth && hasTouch;\n  }\n\n  closeAlert() {\n    salla.storage.set('app_install_prompt_disabled', true);\n    // handle closing animation first, then close the banner\n    this.closing = true;\n    this.host.addEventListener(\n      'animationend',\n      () => {\n        this.closing = false\n        this.open = false;\n      },\n      { once: true }\n    );\n  }\n\n\n  render() {\n    return (\n      <Host class={`s-app-install-alert-wrapper ${this.open ? 'open' : ''} ${this.closing ? 'closing' : ''}`} position={this.data.position}>\n        <div>\n          <img src={this.data.icon} width=\"58\" height=\"58\" alt={`${salla.config.get('store.name')}`} />\n        </div>\n        <div class=\"s-app-install-alert-content\">\n          <h2 class=\"s-app-install-alert-title\">{this.data.title}</h2>\n          <p class=\"s-app-install-alert-sub-title\">\n            {this.data.sub_title} {\" \"}\n            <a href={this.ctaLink} target=\"_blank\" aria-label=\"download app\" class=\"s-app-install-alert-cta\">\n              {salla.lang.getWithDefault('blocks.footer.download_app_now', 'حمله الآن')}\n            </a>\n          </p>\n        </div>\n        <button class=\"s-app-install-alert-cancel-button\" onClick={() => this.closeAlert()}>\n          <i class=\"sicon-cancel\"></i>\n        </button>\n      </Host>\n    );\n  }\n}\n"],"mappings":";;;yDAAA,MAAMA,EAA0B,uB,MCMnBC,EAAoB,M,mCAYVC,MAAMC,OAAOC,IAAI,4B,iCAEb,M,aACG,K,CAd5B,iBAAAC,GACEH,MAAMI,SAAQ,KACZC,KAAKC,KAAON,MAAMC,OAAOC,IAAI,4BAC7B,IAAKG,KAAKE,yBAA0B,CAClC,M,CAGFF,KAAKG,QAAUR,MAAMC,OAAOC,IAAI,cAAcG,KAAKI,gBAAkB,MAAQ,WAAa,cAC1FC,YAAW,IAAOL,KAAKM,KAAO,MAAO,IAAK,G,CAetC,WAAAF,GACN,MAAMG,EAAKC,UAAUC,UACrB,GAAI,WAAWC,KAAKH,GAAK,CACvB,MAAO,S,MACF,GACL,mBAAmBG,KAAKH,IACvB,aAAaG,KAAKF,UAAUC,YAAc,eAAgBE,SAC3D,CACA,MAAO,K,CAET,MAAO,O,CASD,sBAAAT,CAAuBU,EAAS,MACtC,MAAMC,EAAcC,OAAOC,YAAcH,EACzC,MAAMI,EAAiB,sCAAsCN,KAAKF,UAAUC,WAC5E,MAAMQ,EACJ,iBAAkBH,QAClB,eAAgBH,UAChBH,UAAUU,eAAiB,EAE7B,OAAOF,GAAkBH,GAAeI,C,CAG1C,UAAAE,GACExB,MAAMyB,QAAQC,IAAI,8BAA+B,MAEjDrB,KAAKsB,QAAU,KACftB,KAAKuB,KAAKC,iBACR,gBACA,KACExB,KAAKsB,QAAU,MACftB,KAAKM,KAAO,KAAK,GAEnB,CAAEmB,KAAM,M,CAKZ,MAAAC,GACE,OACEC,EAACC,EAAI,CAACC,MAAO,+BAA+B7B,KAAKM,KAAO,OAAS,MAAMN,KAAKsB,QAAU,UAAY,KAAMQ,SAAU9B,KAAKC,KAAK6B,UAC1HH,EAAA,WACEA,EAAA,OAAKI,IAAK/B,KAAKC,KAAK+B,KAAMC,MAAM,KAAKC,OAAO,KAAKC,IAAK,GAAGxC,MAAMC,OAAOC,IAAI,mBAE5E8B,EAAA,OAAKE,MAAM,+BACTF,EAAA,MAAIE,MAAM,6BAA6B7B,KAAKC,KAAKmC,OACjDT,EAAA,KAAGE,MAAM,iCACN7B,KAAKC,KAAKoC,UAAS,IAAG,IACvBV,EAAA,KAAGW,KAAMtC,KAAKG,QAASoC,OAAO,SAAQ,aAAY,eAAeV,MAAM,2BACpElC,MAAM6C,KAAKC,eAAe,iCAAkC,gBAInEd,EAAA,UAAQE,MAAM,oCAAoCa,QAAS,IAAM1C,KAAKmB,cACpEQ,EAAA,KAAGE,MAAM,kB"}